# php简要札记

---

$$
了解http的请求，有助于我们更加清楚页面请求和响应的过程到底发生了什么
$$

## 1.0 HTTP协议

 	关于协议

​	对于应用层开发人员，接触最多的网络协议通常都是传输层的TCP，为什么这么说，因为再往上的应用层协议，如：HTTP、HTTPS、POP3、SMTP、RPC、FTP、TELNET等等都是基于TCP传输层协议。但对于IP协议，对于应用程序员来说更多的印象还是IP地址这个东西，实际上IP协议是位于TCP协议之下的网络层，对于应用层程序员来说很难直接接触

​	IP协议 ：  IP的责任就是把数据从源传送到目的地。它不负责保证传送可靠性，流控制，包顺序和其它对于主机到主机协议来说很普通的服务

​	TCP协议：TCP（Transmission Control Protocol 传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议

​	HTTP协议：HTTP 是基于 TCP/IP 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格式，默认使用80端口



#### TCP协议的3次握手

​	在我们获得页面数据之前，客户端需要与服务器端进行三次握手的"问候"

![66e67](images\687474703a2f2f6f6f327239726e7a702e626b742e636c6f7564646e2e636f6d2f3630363537332d32303137303331373139313333363933322d313635343735313132332e706e67.png)

​	简单来说：

​		1， 客户端向服务器发起问候，携带编号number

​		2， 服务器如果收到客户端的问候，回复问候，携带其他编号number

​		3，客户端确认连接成功，回复服务器收到返回的数据

![Connection_TCP](images\Connection_TCP.png)

​	

为什么是3次握手？

​	这个问题的本质是, 通信不可靠, 但是通信双发需要就某个问题达成一致. 而要解决这个问题, 无论你在消息中包含什么信息, 三次通信是理论上的最小值

​	已失效的连接请求报文段的产生在这样一种情况下：

 - client发出的第一个连接请求报文段并没有丢失，而是在某个网络结点长时间的滞留了，以致延误到连接释放以后的某个时间才到达server。
 - 本来这是一个早已失效的报文段。但server收到此失效的连接请求报文段后，就误认为是client再次发出的一个新的连接请求。于是就向client发出确认报文段，同意建立连接。
 - 假设不采用“三次握手”，那么只要server发出确认，新的连接就建立了。由于现在client并没有发出建立连接的请求，因此不会理睬server的确认，也不会向server发送数据。
 - 但server却以为新的运输连接已经建立，并一直等待client发来数据。这样，server的很多资源就白白浪费掉了。
 - 采用“三次握手”的办法可以防止上述现象发生。例如刚才那种情况，client不会向server的确认发出确认。server由于收不到确认，就知道client并没有要求建立连接



![4time](images\4time.jpg)





#### 4次挥手怎么回事 

- TCP协议是一种面向连接的、可靠的、基于字节流的运输层通信协议。
- TCP是全双工模式，这就意味着，当主机1发出FIN报文段时，只是表示主机1已经没有数据要发送了，主机1告诉主机2，它的数据已经全部发送完毕了；
- 但是，这个时候主机1还是可以接受来自主机2的数据；当主机2返回ACK报文段时，表示它已经知道主机1没有数据发送了，但是主机2还是可以发送数据到主机1的；
- 当主机2也发送了FIN报文段时，这个时候就表示主机2也没有数据要发送了，就会告诉主机1，我也没有数据要发送了，之后彼此就会愉快的中断这次TCP连接。
- 如果要正确的理解四次分手的原理，就需要了解四次分手过程中的状态变化

---



## HTTP协议无状态



#### HTTP会话

​	客户端打开与服务器的连接发出请求到服务器响应客户端请求的全过程称之为会话



#### HTTP无状态

​	HTTP协议，本来是进行共享多个计算机之间的文件而产生的文件传输协议

​	而请求的时候，服务器没有记录当前的信息

​	就比如，去火车站取票，刷身份证拿到票之后，整个会话结束，不会有任何记录

==============

​	动态网站的出现，表单提交，购物车的DOM操作，付款的跳转...

​	有了交互的需要，需要携带一些数据在不同页面之间跳转，无凭无据的，可如何是好